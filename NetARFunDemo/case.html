<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
    <script src="https://aframe.io/releases/0.7.1/aframe.min.js"></script>
    <script src='/node_modules/ar.js/aframe/build/aframe-ar.js'></script>
    <script src="https://unpkg.com/aframe-text-geometry-component@^0.5.0/dist/aframe-text-geometry-component.min.js"></script>
    <script src="https://unpkg.com/aframe-animation-component@4.0.0-beta8/dist/aframe-animation-component.min.js"></script>
    <script>ARjs.Context.baseURL = '/node_modules/ar.js/three.js/'</script>
    <script src="/customComponents/utils.js"></script>
    <script>
        AFRAME.registerComponent('shadow-material', {
            init: function () {
                var mesh = this.el.getObject3D('mesh');
                mesh.material = new THREE.ShadowMaterial();
                mesh.material.opacity = 0.7;
            },
        });

        AFRAME.registerComponent('slide1-material', {
            dependencies: ['geometry'],
            init: function() {
                var mesh = this.el.getObject3D('mesh');

                var textureFront = new THREE.ImageUtils.loadTexture('/content/images/screens/1.png' );      
                var textureBack = new THREE.ImageUtils.loadTexture('/content/images/screens/1.png' );

                var materials = [
                    new THREE.MeshBasicMaterial({map: textureFront}),
                    new THREE.MeshBasicMaterial({map: textureBack}),
                    new THREE.MeshBasicMaterial({color: 0xb7b7b7})];

                mesh.material = new THREE.MeshFaceMaterial(materials);

                for (var i = 0; i < mesh.geometry.faces.length; i++) {
                    var face = mesh.geometry.faces[i];
                    if (parseInt(i / 2) == 4) {
                        face.materialIndex = 0;
                    } else if(parseInt(i / 2) == 5) {
                        face.materialIndex = 1;
                    } else {
                        face.materialIndex = 2;
                    }
                }
            }
        });

        AFRAME.registerComponent('slide2-material', {
            dependencies: ['geometry'],
            init: function () {
                var mesh = this.el.getObject3D('mesh');

                var textureFront = new THREE.ImageUtils.loadTexture('/content/images/screens/2.png');
                var textureBack = new THREE.ImageUtils.loadTexture('/content/images/screens/2.png');

                var materials = [
                    new THREE.MeshBasicMaterial({ map: textureFront }),
                    new THREE.MeshBasicMaterial({ map: textureBack }),
                    new THREE.MeshBasicMaterial({ color: 0xb7b7b7 })];

                mesh.material = new THREE.MeshFaceMaterial(materials);

                for (var i = 0; i < mesh.geometry.faces.length; i++) {
                    var face = mesh.geometry.faces[i];
                    if (parseInt(i / 2) == 4) {
                        face.materialIndex = 0;
                    } else if (parseInt(i / 2) == 5) {
                        face.materialIndex = 1;
                    } else {
                        face.materialIndex = 2;
                    }
                }
            }
        });

        AFRAME.registerComponent('slide3-material', {
            dependencies: ['geometry'],
            init: function () {
                var mesh = this.el.getObject3D('mesh');

                var textureFront = new THREE.ImageUtils.loadTexture('/content/images/screens/3.png');
                var textureBack = new THREE.ImageUtils.loadTexture('/content/images/screens/3.png');

                var materials = [
                    new THREE.MeshBasicMaterial({ map: textureFront }),
                    new THREE.MeshBasicMaterial({ map: textureBack }),
                    new THREE.MeshBasicMaterial({ color: 0xb7b7b7 })];

                mesh.material = new THREE.MeshFaceMaterial(materials);

                for (var i = 0; i < mesh.geometry.faces.length; i++) {
                    var face = mesh.geometry.faces[i];
                    if (parseInt(i / 2) == 4) {
                        face.materialIndex = 0;
                    } else if (parseInt(i / 2) == 5) {
                        face.materialIndex = 1;
                    } else {
                        face.materialIndex = 2;
                    }
                }
            }
        });

        AFRAME.registerComponent('slide4-material', {
            dependencies: ['geometry'],
            init: function () {
                var mesh = this.el.getObject3D('mesh');

                var textureFront = new THREE.ImageUtils.loadTexture('/content/images/screens/4.png');
                var textureBack = new THREE.ImageUtils.loadTexture('/content/images/screens/4.png');

                var materials = [
                    new THREE.MeshBasicMaterial({ map: textureFront }),
                    new THREE.MeshBasicMaterial({ map: textureBack }),
                    new THREE.MeshBasicMaterial({ color: 0xb7b7b7 })];

                mesh.material = new THREE.MeshFaceMaterial(materials);

                for (var i = 0; i < mesh.geometry.faces.length; i++) {
                    var face = mesh.geometry.faces[i];
                    if (parseInt(i / 2) == 4) {
                        face.materialIndex = 0;
                    } else if (parseInt(i / 2) == 5) {
                        face.materialIndex = 1;
                    } else {
                        face.materialIndex = 2;
                    }
                }
            }
        });

        AFRAME.registerComponent('slide5-material', {
            dependencies: ['geometry'],
            init: function () {
                var mesh = this.el.getObject3D('mesh');

                var textureFront = new THREE.ImageUtils.loadTexture('/content/images/screens/5.png');
                var textureBack = new THREE.ImageUtils.loadTexture('/content/images/screens/5.png');

                var materials = [
                    new THREE.MeshBasicMaterial({ map: textureFront }),
                    new THREE.MeshBasicMaterial({ map: textureBack }),
                    new THREE.MeshBasicMaterial({ color: 0xb7b7b7 })];

                mesh.material = new THREE.MeshFaceMaterial(materials);

                for (var i = 0; i < mesh.geometry.faces.length; i++) {
                    var face = mesh.geometry.faces[i];
                    if (parseInt(i / 2) == 4) {
                        face.materialIndex = 0;
                    } else if (parseInt(i / 2) == 5) {
                        face.materialIndex = 1;
                    } else {
                        face.materialIndex = 2;
                    }
                }
            }
        });

    </script>
</head>
<body style='margin : 0px; overflow: hidden; font-family: Monospace; background-color: black;'>
    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false; trackingMethod: area-artoolkit'
             vr-mode-ui="enabled: false">
        <a-entity id="container" position="0 0 0" scale="1.5 1.5 1.5">
            <a-entity id="phone" visible="true" rotation="-65 0 0" position="0 0.25 0.65">
                <a-entity scale="0.05 0.05 0.05" obj-model="obj: url(/content/models/Iphone/mobile-phone.obj); mtl: url(/content/models/Iphone/mobile-phone.mtl);">
                </a-entity>

                <a-entity id="slide1"
                          visible="false"
                          position="0.015 0.8 0.1">
                    <a-entity geometry="primitive: box; buffer: false; width: 0.65; height: 1.26; depth: 0.01;"
                              material="npot: true; shader:flat; vertexColors: face;"
                              slide1-material>
                    </a-entity>
                </a-entity>


                <a-entity id="slide2"
                          visible="false"
                          position="0.015 0.8 0.1">
                    <a-entity geometry="primitive: box; buffer: false; width: 0.65; height: 1.26; depth: 0.01;"
                              material="npot: true; shader:flat; vertexColors: face;"
                              slide2-material>
                    </a-entity>
                </a-entity>


                <a-entity id="slide3"
                          visible="false"
                          position="0.015 0.8 0.1">
                    <a-entity geometry="primitive: box; buffer: false; width: 0.65; height: 1.26; depth: 0.01;"
                              material="npot: true; shader:flat; vertexColors: face;"
                              slide3-material>
                    </a-entity>
                </a-entity>
                
                <a-entity id="slide4"
                          visible="false"
                          position="0.015 0.8 0.1">
                    <a-entity geometry="primitive: box; buffer: false; width: 0.65; height: 1.26; depth: 0.01;"
                              material="npot: true; shader:flat; vertexColors: face;"
                              slide4-material>
                    </a-entity>
                </a-entity>
                
                <a-entity id="slide5"
                          visible="false"
                          position="0.015 0.8 0.1">
                    <a-entity geometry="primitive: box; buffer: false; width: 0.65; height: 1.26; depth: 0.01;"
                              material="npot: true; shader:flat; vertexColors: face;"
                              slide5-material>
                    </a-entity>
                </a-entity>

            </a-entity>
        </a-entity>
        <a-marker-camera preset='hiro'></a-marker-camera>
    </a-scene>
    <script src="case.js"></script>
</body>
</html>